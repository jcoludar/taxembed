* Poincaré Embeddings for NCBI Taxonomy

Learning hierarchical embeddings of organisms using Poincaré geometry.

This project builds on the [[https://github.com/facebookresearch/poincare-embeddings][PyTorch implementation of Poincaré Embeddings]] by Nickel & Kiela (2017), adapted to embed the NCBI taxonomy dataset.

** Overview

This project learns low-dimensional embeddings of ~2.7M organisms from the NCBI taxonomy in hyperbolic space. Taxonomically related organisms (e.g., primates, mammals) are closer together in the embedding space, capturing the hierarchical structure of biological taxonomy.

** Key Features

- Embeddings of 2.7M+ organisms from NCBI taxonomy
- Hyperbolic geometry for natural hierarchy representation
- Real-time training monitoring with clustering quality metrics
- Per-epoch checkpointing for early stopping
- Fixed initialization and data loading for proper training

** Installation

#+BEGIN_SRC sh
  git clone https://github.com/jcoludar/taxembed.git
  cd taxembed
  python -m venv venv
  source venv/bin/activate
  pip install -r requirements.txt
  python setup.py build_ext --inplace
#+END_SRC

** Quick Start

*** Prepare Data
#+BEGIN_SRC sh
  python prepare_taxonomy_data.py
  python remap_edges.py
#+END_SRC

*** Train Model
#+BEGIN_SRC sh
  python embed.py \
    -dset data/taxonomy_edges.mapped.edgelist \
    -checkpoint taxonomy_model.pth \
    -dim 10 \
    -epochs 50 \
    -negs 50 \
    -burnin 10 \
    -batchsize 32 \
    -model distance \
    -manifold poincare \
    -lr 0.1 \
    -ndproc 1 \
    -eval_each 999999 \
    -fresh
#+END_SRC

*** Monitor Training
In a separate terminal:
#+BEGIN_SRC sh
  python monitor_training.py
#+END_SRC

Shows real-time clustering quality (primate distances vs random pairs).

** Documentation

- =IMPLEMENTATION_NOTES.md= - Detailed technical notes on fixes and improvements
- =TRAINING_SUMMARY.md= - Training results and metrics
- =FINAL_ASSESSMENT.md= - Quality assessment

** Dependencies

- Python 3.8+
- PyTorch
- NumPy
- Pandas
- UMAP (for visualization)

** References
If you find this code useful for your research, please cite the following paper in your publication:
#+BEGIN_SRC bibtex
@incollection{nickel2017poincare,
  title = {Poincar\'{e} Embeddings for Learning Hierarchical Representations},
  author = {Nickel, Maximilian and Kiela, Douwe},
  booktitle = {Advances in Neural Information Processing Systems 30},
  editor = {I. Guyon and U. V. Luxburg and S. Bengio and H. Wallach and R. Fergus and S. Vishwanathan and R. Garnett},
  pages = {6341--6350},
  year = {2017},
  publisher = {Curran Associates, Inc.},
  url = {http://papers.nips.cc/paper/7213-poincare-embeddings-for-learning-hierarchical-representations.pdf}
}
#+END_SRC

** License
This code is licensed under [[https://creativecommons.org/licenses/by-nc/4.0/][CC-BY-NC 4.0]].

[[https://img.shields.io/badge/License-CC%20BY--NC%204.0-lightgrey.svg]]
